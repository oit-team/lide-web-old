(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-37497597"],{"0337":function(e,t,a){},"16a4":function(e,t,a){},"22db":function(e,t,a){},2481:function(e,t,a){"use strict";a("16a4")},"31ef":function(e,t,a){"use strict";a("48b5")},"48b5":function(e,t,a){},"4b71":function(e,t,a){},"56bb":function(e,t,a){},"60fd":function(e,t,a){},"711d":function(e,t,a){},"72fc":function(e,t,a){"use strict";a("60fd")},8433:function(e,t,a){"use strict";a("0337")},"9b7a":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",{staticClass:"AuctionConfig"},[a("el-aside",{staticClass:"scrollbar",attrs:{width:"240px"}},[a("div",{staticClass:"AuctionMenu"},[a("div",{staticClass:"addMenu"},[a("el-button",{attrs:{size:"mini",icon:"el-icon-plus"},on:{click:function(t){return e.handleAddClick("menuDrawer")}}},[e._v(" 添加 ")]),a("el-button",{attrs:{size:"mini",icon:"el-icon-setting"},on:{click:function(t){e.couponDrawer=!0}}},[e._v(" 券配置 ")])],1),0==e.menuList.length?a("span",{staticClass:"menuNull"},[e._v("暂无数据")]):e._e(),e._l(e.menuList,(function(t,i){return a("el-button",{key:t.id,staticClass:"animate",class:{active:t.id===e.activeMenu.id},on:{click:function(a){return e.menuClick(t)}},nativeOn:{contextmenu:function(a){return a.preventDefault(),e.rightClick("menuDrawer",t)}}},[a("div",{staticClass:"left animate"},[a("span",[e._v(e._s(i+1))])]),a("div",{staticClass:"center"},[a("span",{staticClass:"animate"},[e._v(e._s(t.conferenceHallName))]),a("span",[e._v(e._s(e.$moment(t.startTime).format("HH:mm")+" - "+e.$moment(t.endTime).format("HH:mm")))])]),a("div",{staticClass:"right"},[a("span",{on:{click:function(e){e.stopPropagation(),e.preventDefault()}}},[a("el-switch",{attrs:{disabled:0==e.roomList.length,"active-color":"#8d1323","inactive-color":"#BFBFBF"},on:{change:function(a){return e.menuChange(t)}},model:{value:0==t.state,callback:function(a){e.$set(t,"state == 0",a)},expression:"item.state == 0"}})],1)])])}))],2)]),a("el-container",{attrs:{id:"Content"}},[a("div",{staticClass:"scrollbar",staticStyle:{height:"48px",background:"#fff",border:"0px","line-height":"28px",padding:"10px",overflow:"auto"},attrs:{id:"roomBox"}},[a("el-checkbox-group",{model:{value:e.roomCheckList,callback:function(t){e.roomCheckList=t},expression:"roomCheckList"}},[e._l(e.roomList,(function(t,i){return a("el-checkbox",{key:t.roomCode,attrs:{label:t.roomCode},on:{change:function(a){return e.roomCheckListChange(a,t)}},nativeOn:{contextmenu:function(a){return a.preventDefault(),e.rightClick("areaDrawer",t)}}},[e._v(e._s(t.roomName))])})),a("div",{staticClass:"addBtn"},[a("el-button",{attrs:{disabled:e.inDuringDate,size:"mini",type:"danger",icon:"el-icon-plus",circle:""},on:{click:function(t){return e.openDrawer("areaDrawer")}}})],1)],2)],1),a("div",[a("el-header",{staticClass:"scrollbar",attrs:{height:"auto"}},[a("div",{staticClass:"AuctionMenu"},[0==e.associatedRoom.length?a("div",{staticClass:"roomNull"},[a("span",[e._v("暂无数据")])]):e._e(),e._l(e.associatedRoom,(function(t){return a("div",{key:t.roomId},[a("el-button",{staticClass:"animate",class:{active:t.roomId===e.activeRoom.roomId},on:{click:function(a){return e.roomClick(t)}}},[a("span",[e._v(e._s(t.roomName))]),a("span",{on:{click:function(e){e.stopPropagation(),e.preventDefault()}}},[a("el-switch",{attrs:{disabled:e.inDuringDate,"active-color":"#8d1323","inactive-color":"#BFBFBF"},on:{change:function(a){return e.menuChange(t,1)}},model:{value:0==t.state,callback:function(a){e.$set(t,"state == 0",a)},expression:"item.state == 0"}})],1)])],1)}))],2)]),a("el-main",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[a("div",{staticClass:"AuctionManage"},[a("span",[e._v("预约人数（有券）："+e._s(e.relationInfo.haveTicketAppointedNum)+"人")]),a("span",[e._v("预约人数（无券）："+e._s(e.relationInfo.noTicketAppointedNum)+"人")]),a("span",[e._v("抢购人数："+e._s(e.relationInfo.auctionNum)+"人")]),a("span",[e._v("积分限制："),a("span",{staticStyle:{color:"#8d1323",cursor:"pointer"},on:{click:e.openRelationDrawer}},[e._v(e._s(e.relationInfo.integralLimit)),a("i",{staticClass:"el-icon-edit",staticStyle:{"margin-left":"4px"}})])]),a("span",[e._v("宝玉限制："),a("span",{staticStyle:{color:"#8d1323",cursor:"pointer"},on:{click:e.openRelationDrawer}},[e._v(e._s(e.relationInfo.byLimit)),a("i",{staticClass:"el-icon-edit",staticStyle:{"margin-left":"4px"}})])])]),a("div",[a("el-checkbox-group",{staticClass:"scrollbar",attrs:{id:"ImgList"},model:{value:e.checkList,callback:function(t){e.checkList=t},expression:"checkList"}},[e._l(e.goodsList,(function(t){return a("div",{key:t.goodsCode},[a("span",{staticClass:"deleteBox"},[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"复制价格",placement:"top"}},[a("i",{staticClass:"el-icon-document-copy",staticStyle:{color:"#e6a23c"},on:{click:function(a){return e.ClickCopy(t)}}})]),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"top"}},[a("i",{staticClass:"el-icon-delete",staticStyle:{color:"#8d1323"},on:{click:function(a){return e.deleteGoods(t)}}})])],1),a("div",{staticClass:"imgBox"},[t.resUrl||t.mainImage&&t.mainImage.length>0?a("img",{attrs:{src:t.resUrl||t.mainImage[0].resUrl,alt:""}}):a("span",[e._v("暂无图片")])]),a("el-checkbox",{attrs:{label:t.goodsCode},on:{change:function(t){return e.handleCheckedChange()}}},[e._v(e._s(t.goodsName))])],1)})),a("div",{staticClass:"addImg"},[a("div",{class:e.inDuringDate||0==e.associatedRoom.length?"disabled":"",on:{click:function(t){return e.openDrawer("goodsDrawer")}}},[a("i",{staticClass:"el-icon-plus"})])])],2)],1),a("div",{staticClass:"Price"},[a("div",[a("el-form",{ref:"ruleForm",staticClass:"PriceFrom",attrs:{rules:e.rules,model:e.ruleForm,"label-width":"76px"}},[a("el-form-item",{attrs:{label:"起拍价",prop:"biddingPrice"}},[a("el-input",{attrs:{oninput:"value=value.replace(/[^\\d\\.]/g, '').replace(/^\\./g, '').replace(/\\.{2,}/g, '.').replace('.', '$#$').replace(/\\./g, '').replace('$#$', '.')"},model:{value:e.ruleForm.biddingPrice,callback:function(t){e.$set(e.ruleForm,"biddingPrice",t)},expression:"ruleForm.biddingPrice"}},[a("i",{attrs:{slot:"suffix"},slot:"suffix"},[e._v("元")])])],1),a("el-form-item",{attrs:{label:"交割价",prop:"transactionPrice"}},[a("el-input",{attrs:{oninput:"value=value.replace(/[^\\d\\.]/g, '').replace(/^\\./g, '').replace(/\\.{2,}/g, '.').replace('.', '$#$').replace(/\\./g, '').replace('$#$', '.')"},model:{value:e.ruleForm.transactionPrice,callback:function(t){e.$set(e.ruleForm,"transactionPrice",t)},expression:"ruleForm.transactionPrice"}},[a("i",{attrs:{slot:"suffix"},slot:"suffix"},[e._v("元")])])],1),a("el-form-item",{attrs:{label:"起始定金",prop:"depositPrice"}},[a("el-input",{attrs:{oninput:"value=value.replace(/[^\\d\\.]/g, '').replace(/^\\./g, '').replace(/\\.{2,}/g, '.').replace('.', '$#$').replace(/\\./g, '').replace('$#$', '.')"},model:{value:e.ruleForm.depositPrice,callback:function(t){e.$set(e.ruleForm,"depositPrice",t)},expression:"ruleForm.depositPrice"}},[a("i",{attrs:{slot:"suffix"},slot:"suffix"},[e._v("元")])])],1),a("el-form-item",{attrs:{label:"溢价比",prop:"premiumRatio"}},[a("el-input",{attrs:{oninput:"value=value.replace(/[^\\d\\.]/g, '').replace(/^\\./g, '').replace(/\\.{2,}/g, '.').replace('.', '$#$').replace(/\\./g, '').replace('$#$', '.')"},model:{value:e.ruleForm.premiumRatio,callback:function(t){e.$set(e.ruleForm,"premiumRatio",t)},expression:"ruleForm.premiumRatio"}},[a("i",{attrs:{slot:"suffix"},slot:"suffix"},[e._v("%")])])],1),a("el-form-item",{attrs:{label:"积分比",prop:"integralRatio"}},[a("el-input",{attrs:{oninput:"value=value.replace(/[^\\d\\.]/g, '').replace(/^\\./g, '').replace(/\\.{2,}/g, '.').replace('.', '$#$').replace(/\\./g, '').replace('$#$', '.')"},model:{value:e.ruleForm.integralRatio,callback:function(t){e.$set(e.ruleForm,"integralRatio",t)},expression:"ruleForm.integralRatio"}},[a("i",{attrs:{slot:"suffix"},slot:"suffix"},[e._v("%")])])],1),a("el-form-item",{attrs:{label:"定金比",prop:"depositRatio"}},[a("el-input",{attrs:{oninput:"value=value.replace(/[^\\d\\.]/g, '').replace(/^\\./g, '').replace(/\\.{2,}/g, '.').replace('.', '$#$').replace(/\\./g, '').replace('$#$', '.')"},model:{value:e.ruleForm.depositRatio,callback:function(t){e.$set(e.ruleForm,"depositRatio",t)},expression:"ruleForm.depositRatio"}})],1),a("el-form-item",{attrs:{label:"个人收益",prop:"profitRatio"}},[a("el-input",{attrs:{oninput:"value=value.replace(/[^\\d\\.]/g, '').replace(/^\\./g, '').replace(/\\.{2,}/g, '.').replace('.', '$#$').replace(/\\./g, '').replace('$#$', '.')"},model:{value:e.ruleForm.profitRatio,callback:function(t){e.$set(e.ruleForm,"profitRatio",t)},expression:"ruleForm.profitRatio"}},[a("i",{attrs:{slot:"suffix"},slot:"suffix"},[e._v("%")])])],1),a("el-form-item",{attrs:{label:"平台收益",prop:"platformRatio"}},[a("el-input",{attrs:{oninput:"value=value.replace(/[^\\d\\.]/g, '').replace(/^\\./g, '').replace(/\\.{2,}/g, '.').replace('.', '$#$').replace(/\\./g, '').replace('$#$', '.')"},model:{value:e.ruleForm.platformRatio,callback:function(t){e.$set(e.ruleForm,"platformRatio",t)},expression:"ruleForm.platformRatio"}},[a("i",{attrs:{slot:"suffix"},slot:"suffix"},[e._v("%")])])],1),a("el-button",{attrs:{type:"primary",disabled:e.inDuringDate||0==e.associatedRoom.length},on:{click:e.getCalculatePrice}},[e._v("模拟生成")]),a("el-button",{attrs:{type:"primary",disabled:e.inDuringDate||0==e.associatedRoom.length},on:{click:e.addGoodsAndPriceDetailed}},[e._v("保存价格")])],1)],1)]),a("div",{staticClass:"tableBox"},[a("el-table",{ref:"priceRef",staticStyle:{width:"100%"},attrs:{data:e.prices,border:"","row-class-name":e.rowClass,"highlight-current-row":""},on:{select:e.handleSelect,"select-all":e.handleALL}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),a("el-table-column",{attrs:{label:"序号",width:"55"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.$index+1))])]}}])}),a("el-table-column",{attrs:{label:"平台分润",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{ref:"platformRevenue"+t.$index,attrs:{oninput:"value=value.replace(/[^\\d\\.]/g, '').replace(/^\\./g, '').replace(/\\.{2,}/g, '.').replace('.', '$#$').replace(/\\./g, '').replace('$#$', '.')",placeholder:"平台分润"},on:{blur:function(a){return e.checkNull(t.row,t.$index,"platformRevenue","平台分润")}},model:{value:t.row.platformRevenue,callback:function(a){e.$set(t.row,"platformRevenue",a)},expression:"scope.row.platformRevenue"}})]}}])}),a("el-table-column",{attrs:{label:"扣除积分",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{ref:"deductPoints"+t.$index,attrs:{oninput:"value=value.replace(/[^\\d\\.]/g, '').replace(/^\\./g, '').replace(/\\.{2,}/g, '.').replace('.', '$#$').replace(/\\./g, '').replace('$#$', '.')",placeholder:"扣除积分"},on:{blur:function(a){return e.checkNull(t.row,t.$index,"deductPoints","扣除积分")}},model:{value:t.row.deductPoints,callback:function(a){e.$set(t.row,"deductPoints",a)},expression:"scope.row.deductPoints"}})]}}])}),a("el-table-column",{attrs:{label:"应付定金",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{ref:"deposit"+t.$index,attrs:{oninput:"value=value.replace(/[^\\d\\.]/g, '').replace(/^\\./g, '').replace(/\\.{2,}/g, '.').replace('.', '$#$').replace(/\\./g, '').replace('$#$', '.')",placeholder:"应付定金"},on:{blur:function(a){return e.checkNull(t.row,t.$index,"deposit","应付定金")}},model:{value:t.row.deposit,callback:function(a){e.$set(t.row,"deposit",a)},expression:"scope.row.deposit"}})]}}])}),a("el-table-column",{attrs:{label:"个人分润",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{ref:"personalIncome"+t.$index,attrs:{oninput:"value=value.replace(/[^\\d\\.]/g, '').replace(/^\\./g, '').replace(/\\.{2,}/g, '.').replace('.', '$#$').replace(/\\./g, '').replace('$#$', '.')",placeholder:"个人分润"},on:{blur:function(a){return e.checkNull(t.row,t.$index,"personalIncome","个人分润")}},model:{value:t.row.personalIncome,callback:function(a){e.$set(t.row,"personalIncome",a)},expression:"scope.row.personalIncome"}})]}}])}),a("el-table-column",{attrs:{label:"竞拍价",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{ref:"biddingPriceInput"+t.$index,attrs:{oninput:"value=value.replace(/[^\\d\\.]/g, '').replace(/^\\./g, '').replace(/\\.{2,}/g, '.').replace('.', '$#$').replace(/\\./g, '').replace('$#$', '.')",placeholder:"竞拍价"},on:{blur:function(a){return e.checkNull(t.row,t.$index,"biddingPrice","竞拍价")}},model:{value:t.row.biddingPrice,callback:function(a){e.$set(t.row,"biddingPrice",a)},expression:"scope.row.biddingPrice"}})]}}])}),a("el-table-column",{attrs:{label:"溢价",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{ref:"premiumPrice"+t.$index,attrs:{oninput:"value=value.replace(/[^\\d\\.]/g, '').replace(/^\\./g, '').replace(/\\.{2,}/g, '.').replace('.', '$#$').replace(/\\./g, '').replace('$#$', '.')",placeholder:"溢价"},on:{blur:function(a){return e.checkNull(t.row,t.$index,"premiumPrice","溢价")}},model:{value:t.row.premiumPrice,callback:function(a){e.$set(t.row,"premiumPrice",a)},expression:"scope.row.premiumPrice"}})]}}])})],1)],1)])],1)]),a("vc-menudrawer",{ref:"menuDrawer",on:{reloadManage:e.reloadManage}}),a("vc-areadrawer",{ref:"areaDrawer",on:{reloadManage:e.reloadManage}}),a("vc-goodsdrawer",{ref:"goodsDrawer",on:{addGoods:e.addGoods}}),a("vc-relationdrawer",{ref:"relationDrawer",on:{relationChange:e.relationChange}}),a("vc-copyprice",{ref:"copyPrice",on:{CopyGoodsPrice:e.CopyGoodsPrice}}),a("vc-copyhistory",{ref:"copyhistory",on:{CopyHistory:e.CopyHistory}}),a("el-dialog",{attrs:{title:e.drawerData.conferenceHallName||e.drawerData.roomName||"test",visible:e.centerDialogVisible,width:"30%",center:""},on:{"update:visible":function(t){e.centerDialogVisible=t}}},[a("span",[e._v("请选择您的操作")]),a("el-dialog",{attrs:{width:"30%",title:"提示",visible:e.innerVisible,center:"","append-to-body":""},on:{"update:visible":function(t){e.innerVisible=t}}},[a("span",[e._v("确认删除")]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.deleteItem}},[e._v("确 认")]),a("el-button",{attrs:{type:"primary"},on:{click:e.closeDialog}},[e._v("取 消")])],1)]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.handleEditClick}},[e._v("编 辑")]),a("el-button",{attrs:{type:"success"},on:{click:e.handleCopyHistory}},[e._v("复 制")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.innerVisible=!0}}},[e._v("删 除")])],1)],1),a("el-drawer",{attrs:{visible:e.couponDrawer,title:"竞拍券配置"},on:{"update:visible":function(t){e.couponDrawer=t}}},[a("el-form",{staticClass:"px-6",attrs:{"label-width":"7rem",model:e.form}},[a("el-form-item",{attrs:{label:"所需积分"}},[a("el-input",{attrs:{type:"number"},model:{value:e.form.auctionTicket,callback:function(t){e.$set(e.form,"auctionTicket",t)},expression:"form.auctionTicket"}})],1),a("el-form-item",{attrs:{label:"有效天数"}},[a("el-input",{attrs:{type:"number"},model:{value:e.form.validDays,callback:function(t){e.$set(e.form,"validDays",t)},expression:"form.validDays"}})],1),a("el-form-item",{attrs:{label:"兑换比例"}},[a("el-input",{attrs:{type:"number"},model:{value:e.form.integral,callback:function(t){e.$set(e.form,"integral",t)},expression:"form.integral"}},[a("template",{slot:"append"},[e._v("%")])],2)],1),a("el-form-item",{attrs:{label:"可使用次数"}},[a("el-input",{attrs:{type:"number"},model:{value:e.form.usedTime,callback:function(t){e.$set(e.form,"usedTime",t)},expression:"form.usedTime"}})],1),a("div",[a("el-button",{staticClass:"w-full",attrs:{type:"primary"},on:{click:e.saveCouponConfig}},[e._v("保存")])],1)],1)],1)],1)},o=[],s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"menuDrawer"},[a("el-drawer",{attrs:{title:"专场信息","append-to-body":!0,"modal-append-to-body":!0,"before-close":e.handleClose,visible:e.menuDrawer,direction:e.direction}},[a("el-form",{ref:"menuruleForm",staticStyle:{width:"80%",margin:"0 auto"},attrs:{model:e.menuRuleForm,rules:e.menuRules}},[a("el-form-item",{attrs:{label:"场次名称",prop:"Name"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入场次名称"},model:{value:e.menuRuleForm.Name,callback:function(t){e.$set(e.menuRuleForm,"Name","string"===typeof t?t.trim():t)},expression:"menuRuleForm.Name"}})],1),a("el-form-item",{attrs:{label:"场次时间",required:"",prop:"Time"}},[a("el-time-picker",{staticStyle:{width:"100%"},attrs:{"is-range":"",format:"HH:mm","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间",placeholder:"请选择时间范围"},model:{value:e.menuRuleForm.Time,callback:function(t){e.$set(e.menuRuleForm,"Time",t)},expression:"menuRuleForm.Time"}})],1)],1),a("div",{staticStyle:{width:"80%",margin:"0 auto"}},[a("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary"},on:{click:e.submit}},[e._v("提交")])],1)],1)],1)},r=[],l={name:"menuDrawer",data(){return{isAdd:!1,menuDrawer:!1,direction:"rtl",auctionData:{},menuRuleForm:{Name:"",Time:""},menuRules:{Name:[{required:!0,message:"请输入场次名称"}],Time:[{required:!0,message:"请输入场次名称"}]}}},created(){},mounted(){},methods:{handleClose(){this.$refs.menuruleForm.resetFields(),this.menuRuleForm.Time="",this.menuRuleForm.Name="",this.menuDrawer=!1},handleOpen(e){this.menuDrawer=!0,e?(this.isAdd=!1,this.auctionData=e,this.menuRuleForm.Name=e.conferenceHallName,this.menuRuleForm.Id=e.id,this.menuRuleForm.Time=this.setTime(e.startTime,e.endTime)):this.isAdd=!0},setTime(e,t){return[new Date(e),new Date(t)]},submit(){const e=this;e.$refs.menuruleForm.validate(t=>{if(t){let t="",a={conferenceHallName:this.menuRuleForm.Name,startTime:e.$moment(this.menuRuleForm.Time[0]).format("HH:mm:00"),endTime:e.$moment(this.menuRuleForm.Time[1]).format("HH:mm:00")};this.isAdd?t=this.Api.addConferenceHall:(a.id=this.menuRuleForm.Id,t=this.Api.updateConferenceHallById);const i=e.GLOBAL.paramJson(a);this.$axios.post(t,i).then(t=>{0===t.data.head.status?(this.isAdd,this.$emit("reloadManage","menuDrawer"),e.handleClose()):e.$message({message:t.data.head.msg,type:"error"})}).catch(e=>{console.log(e)})}})}}},n=l,c=(a("31ef"),a("b709")),d=Object(c["a"])(n,s,r,!1,null,"2bed14a6",null),m=d.exports,u=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"areaDrawer"},[a("el-drawer",{attrs:{title:"房间信息","append-to-body":!0,"modal-append-to-body":!0,"before-close":e.handleClose,visible:e.areaDrawer,direction:e.direction}},[a("el-form",{ref:"arearuleForm",staticStyle:{width:"80%",margin:"0 auto"},attrs:{model:e.areaRuleForm,rules:e.areaRules}},[a("el-form-item",{attrs:{label:"房间名称",prop:"roomName"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入房间名称"},model:{value:e.areaRuleForm.roomName,callback:function(t){e.$set(e.areaRuleForm,"roomName","string"===typeof t?t.trim():t)},expression:"areaRuleForm.roomName"}})],1)],1),a("div",{staticStyle:{width:"80%",margin:"0 auto"}},[a("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary"},on:{click:e.submit}},[e._v("提交")])],1)],1)],1)},h=[],p={name:"areaDrawer",data(){return{isAdd:!1,areaDrawer:!1,direction:"rtl",areaRuleForm:{roomName:"",integralLimit:"",byLimit:""},areaRules:{roomName:[{required:!0,message:"请输入房间名称"}]}}},created(){},mounted(){},methods:{handleClose(){this.$refs.arearuleForm.resetFields(),this.areaDrawer=!1},handleOpen(e){this.areaDrawer=!0,e?(this.isAdd=!1,this.$nextTick((function(){this.areaRuleForm=JSON.parse(JSON.stringify(e))}))):this.isAdd=!0},submit(){const e=this;this.$refs.arearuleForm.validate(t=>{if(t){let t="",a={roomName:this.areaRuleForm.roomName};this.isAdd?t=this.Api.addRoomInfo:(a.id=this.areaRuleForm.roomId,t=this.Api.updateRoomInfo);const i=e.GLOBAL.paramJson(a);this.$axios.post(t,i).then(t=>{0===t.data.head.status?(this.isAdd?this.$emit("reloadManage","areaDrawer"):this.$emit("reloadManage","areaDrawer",a),e.handleClose()):e.$message({message:t.data.head.msg,type:"error"})}).catch(e=>{console.log(e)})}})}}},g=p,f=(a("d8d8"),Object(c["a"])(g,u,h,!1,null,"105b192d",null)),y=f.exports,b=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"goodsDrawer"},[a("el-drawer",{attrs:{title:"选择资源",size:"50%","append-to-body":!0,"modal-append-to-body":!0,"before-close":e.handleClose,visible:e.goodsDrawer,direction:e.direction}},[a("vc-search",{ref:"child",attrs:{headTitArr:e.headTitArr,pageNum:e.pageNum,pageSize:e.pageSize,OtherData:e.OtherData,requestUrl:e.requestUrl},on:{changeLoading:e.changeLoad,sendData:e.showChildData}}),a("div",{staticClass:"operateBtn"},[a("el-button",{attrs:{size:"small",icon:"el-icon-plus",type:"primary"},on:{click:e.addGoods}},[e._v("添加商品")])],1),a("el-divider"),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"elTable",staticStyle:{width:"100%"},attrs:{"element-loading-text":"拼命加载中...",data:e.tableData,"row-key":e.getRowKey,border:""}},[a("el-table-column",{attrs:{type:"selection",selectable:e.selected,"reserve-selection":!0,width:"55"}}),e._l(e.headTitArrNew,(function(t,i){return a("el-table-column",{key:i,attrs:{"show-overflow-tooltip":"",sortable:"","min-width":e.GLOBAL.minCellWidth,prop:t.fieldKey,label:t.fieldName},scopedSlots:e._u([{key:"default",fn:function(i){return["status"==t.fieldKey?a("span",[0===i.row.status?a("span",{staticStyle:{color:"#FF0000"}},[e._v("未上架")]):a("span",{staticStyle:{color:"#42B983"}},[e._v("已上架")])]):"resUrl"==t.fieldKey?a("span",{staticClass:"imgBox"},[i.row.mainImage&&i.row.mainImage.length>0&&i.row.mainImage[0].resUrl?a("img",{staticStyle:{display:"block",margin:"0 auto"},attrs:{src:i.row.mainImage[0].resUrl,alt:""}}):a("span",[e._v("无")])]):a("div",[a("span",[e._v(e._s(i.row[t.fieldKey]))])])]}}],null,!0)})}))],2),a("el-pagination",{attrs:{"current-page":e.pageNum,"page-sizes":[15,20,30],"page-size":100,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)},v=[],C=a("f6d5"),$={name:"goodsDrawer",components:{VcSearch:C["a"]},data(){return{OtherData:{status:"1"},goodsDrawer:!1,direction:"rtl",total:0,pageNum:0,pageSize:15,requestUrl:"",editIndex:null,dynamicParam:[],loading:!0,tableData:[],headTitArr:[]}},computed:{headTitArrNew(){return this.headTitArr.filter(e=>!e.noTableShow)}},created(){const e='[{"fieldName":"商品名称","fieldType":"文本","fieldKey":"goodsName","dbField":"GOODS_NAME"},{"fieldName":"商品图片","fieldType":"图片","fieldKey":"resUrl","dbField":"RES_URL"},{"fieldName":"商品状态","fieldType":"","fieldKey":"statusName","dbField":"STATUS_NAME"},{"fieldName":"商品作者","fieldType":"文本","fieldKey":"authorName","dbField":"AUTHOR_NAME"},{"fieldName":"创建时间","fieldType":"日期","fieldKey":"createTime","dbField":"CREATE_TIME"}]';this.requestUrl=this.Api.getGoodsList,this.headTitArr=JSON.parse(e),this.headTitArr.length<=0&&this.$message({message:"this.headTitArr为空",type:"warning"}),this.dynamicParam=[{key:"pageNum",value:"1",isTrue:!0,msg:"请确认pageNum"},{key:"pageSize",value:"15",isTrue:!0,msg:"请确认pageSize"}]},mounted(){this.pageNum=1,this.dynamicParam.forEach(e=>{"pageNum"===e.key&&(e.value=this.pageNum)})},activated(){this.headTitArr.length<=0&&this.$message({message:"this.headTitArr为空",type:"warning"});const e=this;e.$bus.$off("detailShow"),e.$bus.$on("detailShow",t=>{e.$refs.child.resetSearch(e.dynamicParam,e.pageNum)})},methods:{selected(e,t){return 1==e.status},getRowKey(e){return e.goodsId},handleClose(){this.$refs.elTable.clearSelection(),this.goodsDrawer=!1},loadManage(){this.$nextTick(()=>{this.$refs.child.parentMsgs(this.dynamicParam)})},changeLoad(e){this.loading=e},showChildData(e,t,a,i){e&&(this.tableData=e),t&&(this.total=t),a&&(this.tableEmptyText=a),i&&(this.pageNum=i)},handleSizeChange(e){this.pageSize=e,this.dynamicParam.forEach(e=>{"pageSize"===e.key&&(e.value=this.pageSize)}),this.$refs.child.parentMsgs(this.dynamicParam)},handleCurrentChange(e){this.pageNum=e,this.dynamicParam.forEach(e=>{"pageNum"===e.key&&(e.value=this.pageNum)}),this.$refs.child.parentMsgs(this.dynamicParam)},handleOpen(e){this.goodsDrawer=!0},addGoods(){this.$emit("addGoods",this.$refs.elTable.selection),this.handleClose()}}},w=$,R=(a("e5c1"),Object(c["a"])(w,b,v,!1,null,"8f3be89e",null)),k=R.exports,L=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"auctionRelation"},[a("el-drawer",{attrs:{title:"积分/宝玉信息","append-to-body":!0,"modal-append-to-body":!0,"before-close":e.handleClose,visible:e.RelationDrawer,direction:e.direction}},[a("el-form",{ref:"RelationruleForm",staticStyle:{width:"80%",margin:"0 auto"},attrs:{model:e.RelationRuleForm,rules:e.RelationRules}},[a("el-form-item",{attrs:{label:"积分限制",prop:"integralLimit"}},[a("el-input",{attrs:{oninput:"value=value.replace(/[^\\d]/g,'')",clearable:"",placeholder:"请输入积分"},model:{value:e.RelationRuleForm.integralLimit,callback:function(t){e.$set(e.RelationRuleForm,"integralLimit",e._n(t))},expression:"RelationRuleForm.integralLimit"}})],1),a("el-form-item",{attrs:{label:"宝玉限制",prop:"byLimit"}},[a("el-input",{attrs:{oninput:"value=value.replace(/[^\\d]/g,'')",clearable:"",placeholder:"请输入宝玉"},model:{value:e.RelationRuleForm.byLimit,callback:function(t){e.$set(e.RelationRuleForm,"byLimit",e._n(t))},expression:"RelationRuleForm.byLimit"}})],1)],1),a("div",{staticStyle:{width:"80%",margin:"0 auto"}},[a("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary"},on:{click:e.submit}},[e._v("提交")])],1)],1)],1)},D=[],x={name:"RelationDrawer",data(){return{isAdd:!1,RelationDrawer:!1,direction:"rtl",RelationRuleForm:{byLimit:"",integralLimit:"",conferenceCode:"",roomCode:""},RelationRules:{byLimit:[{required:!0,message:"请输入宝玉",trigger:"blur"},{type:"number",message:"请输入数字",trigger:"blur"}],integralLimit:[{required:!0,message:"请输入积分",trigger:"blur"},{type:"number",message:"请输入数字",trigger:"blur"}]}}},created(){},mounted(){},methods:{handleClose(){this.RelationDrawer=!1},handleOpen(e){this.RelationRuleForm=e,this.RelationDrawer=!0},submit(){const e=this;e.$refs.RelationruleForm.validate(t=>{if(t){let t=this.RelationRuleForm;const a=e.GLOBAL.paramJson(t);this.$axios.post(this.Api.addOrUpdateAuctionRelation,a).then(a=>{0===a.data.head.status?(e.$message({message:a.data.head.msg,type:"success"}),e.$emit("relationChange",t),e.handleClose()):e.$message({message:a.data.head.msg,type:"error"})}).catch(e=>{console.log(e)})}})}}},T=x,_=(a("2481"),Object(c["a"])(T,L,D,!1,null,"13cc6dfa",null)),N=_.exports,F=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"goodsDrawer"},[a("el-drawer",{attrs:{title:"选择资源",size:"50%","append-to-body":!0,"modal-append-to-body":!0,"before-close":e.handleClose,visible:e.goodsDrawer,direction:e.direction}},[a("div",{staticClass:"operateBtn"},[a("el-button",{attrs:{size:"small",icon:"el-icon-plus",type:"primary"},on:{click:e.CopyPrice}},[e._v("复制价格")])],1),a("el-divider"),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"elTable",staticStyle:{width:"100%"},attrs:{"element-loading-text":"拼命加载中...",data:e.tableData,"row-key":e.getRowKey,border:""}},[a("el-table-column",{attrs:{label:"选择",align:"center",width:"65"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-radio",{attrs:{label:t.row.goodsCode},nativeOn:{change:function(a){return e.getCurrentRow(t.row)}},model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[e._v(" "+e._s("")+" ")])]}}])}),e._l(e.headTitArrNew,(function(t,i){return a("el-table-column",{key:i,attrs:{"show-overflow-tooltip":"",sortable:"","min-width":e.GLOBAL.minCellWidth,prop:t.fieldKey,label:t.fieldName},scopedSlots:e._u([{key:"default",fn:function(i){return["status"==t.fieldKey?a("span",[0===i.row.status?a("span",{staticStyle:{color:"#FF0000"}},[e._v("未上架")]):a("span",{staticStyle:{color:"#42B983"}},[e._v("已上架")])]):"resUrl"==t.fieldKey?a("span",{staticClass:"imgBox"},[i.row.mainImage&&i.row.mainImage.length>0&&i.row.mainImage[0].resUrl?a("img",{staticStyle:{display:"block",margin:"0 auto"},attrs:{src:i.row.mainImage[0].resUrl,alt:""}}):i.row.resUrl?a("img",{staticStyle:{display:"block",margin:"0 auto"},attrs:{src:i.row.resUrl,alt:""}}):a("span",[e._v("无")])]):a("div",[a("span",[e._v(e._s(i.row[t.fieldKey]))])])]}}],null,!0)})}))],2)],1)],1)},A=[],P={name:"copyPrice",components:{VcSearch:C["a"]},data(){return{currGoods:"",radio:"",goodsDrawer:!1,direction:"rtl",loading:!0,tableData:[],headTitArr:[]}},computed:{headTitArrNew(){return this.headTitArr.filter(e=>!e.noTableShow)}},created(){const e='[{"fieldName":"商品名称","fieldType":"文本","fieldKey":"goodsName","dbField":"GOODS_NAME"},{"fieldName":"商品图片","fieldType":"图片","fieldKey":"resUrl","dbField":"RES_URL"}]';this.headTitArr=JSON.parse(e),this.headTitArr.length<=0&&this.$message({message:"this.headTitArr为空",type:"warning"})},mounted(){},activated(){this.headTitArr.length<=0&&this.$message({message:"this.headTitArr为空",type:"warning"})},methods:{getRowKey(e){return e.goodsId},handleClose(){this.radio="",this.goodsDrawer=!1},loadManage(){},changeLoad(e){this.loading=e},handleOpen(e,t){this.goodsDrawer=!0;const a=t.filter(t=>t.goodsCode!=e.goodsCode&&t.price instanceof Array);this.tableData=a,this.loading=!1,this.currGoods=e},CopyPrice(){const e=this.tableData.find(e=>e.goodsCode==this.radio);this.currGoods.price=e.price,this.currGoods.startingPrice=e.startingPrice,this.currGoods.transactionPrice=e.transactionPrice,this.currGoods.premiumRatio=e.premiumRatio,this.currGoods.integralRatio=e.integralRatio,this.currGoods.depositRatio=e.depositRatio,this.$emit("CopyGoodsPrice",this.currGoods),this.handleClose()},getCurrentRow(e){}}},S=P,I=(a("e0e0"),Object(c["a"])(S,F,A,!1,null,"7c54328e",null)),M=I.exports,O=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"goodsDrawer"},[a("el-drawer",{attrs:{title:e.title,"append-to-body":!0,"modal-append-to-body":!0,"before-close":e.handleClose,visible:e.goodsDrawer,direction:e.direction}},[a("el-form",{ref:"historyruleForm",staticStyle:{width:"80%",margin:"0 auto"},attrs:{model:e.historyRuleForm,rules:e.historyRules}},[a("el-form-item",{attrs:{label:"被复制场",prop:"copyConferenceCode"}},[a("el-select",{attrs:{placeholder:"请选择被复制的场次"},on:{change:e.HistoryChange},model:{value:e.historyRuleForm.copyConferenceCode,callback:function(t){e.$set(e.historyRuleForm,"copyConferenceCode",t)},expression:"historyRuleForm.copyConferenceCode"}},e._l(e.options,(function(e){return a("el-option",{key:e.conferenceHallCode,attrs:{label:e.conferenceHallName,value:e.conferenceHallCode}})})),1)],1),a("el-form-item",{attrs:{label:"场次时间",prop:"copyTime"}},[e.TimeList.length>0?a("el-radio-group",{staticClass:"TimeListBox",model:{value:e.historyRuleForm.copyTime,callback:function(t){e.$set(e.historyRuleForm,"copyTime",t)},expression:"historyRuleForm.copyTime"}},e._l(e.TimeList,(function(t,i){return a("el-radio",{attrs:{label:t}},[e._v(e._s(t))])})),1):a("div",{staticStyle:{width:"100%",display:"inline-block","text-align":"center",color:"#BFBFBF"}},[e._v("暂无数据")])],1)],1),a("div",{staticStyle:{width:"80%",margin:"0 auto"}},[a("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary"},on:{click:e.submit}},[e._v("提交")])],1)],1)],1)},B=[],H={name:"copyHistory",data(){return{title:"复制场次",currData:"",options:[],TimeList:[],currGoods:"",radio:"",goodsDrawer:!1,direction:"rtl",historyRuleForm:{copyConferenceCode:"",copyTime:""},historyRules:{copyConferenceCode:[{required:!0,message:"请选择被复制的场次"}],copyTime:[{required:!0,message:"请选择场次时间"}]}}},created(){},mounted(){},activated(){},methods:{handleClose(){this.$refs.historyruleForm.resetFields(),this.TimeList=[],this.goodsDrawer=!1},HistoryChange(){this.loadTime(),this.historyRuleForm.copyTime=""},handleOpen(e,t){this.goodsDrawer=!0,this.options=e,this.currData=t,this.title="复制场次--"+t.conferenceHallName},loadTime(){const e={conferenceCode:this.historyRuleForm.copyConferenceCode},t=this,a=this.GLOBAL.paramJson(e);this.$axios.post(this.Api.getAuctionHistoryTime,a).then(e=>{0==e.data.head.status?t.TimeList=e.data.body.resultList:t.$message({message:e.data.head.msg,type:"warning"})}).catch(e=>{console.log(e)})},submit(){this.$refs.historyruleForm.validate(e=>{if(e){const e=this,t=this.historyRuleForm;t.conferenceCode=this.currData.conferenceHallCode;const a=this.GLOBAL.paramJson(t);this.$axios.post(this.Api.addAuctionHistory,a).then(t=>{0==t.data.head.status?(e.$message({type:"success",message:t.data.head.msg}),e.handleClose(),e.$emit("CopyHistory")):e.$message({message:t.data.head.msg,type:"warning"})}).catch(e=>{console.log(e)})}})}}},G=H,K=(a("ef4d"),Object(c["a"])(G,O,B,!1,null,"13e4b182",null)),V=K.exports,E={name:"AuctionConfig",components:{VcMenudrawer:m,VcAreadrawer:y,VcGoodsdrawer:k,VcRelationdrawer:N,VcCopyprice:M,VcCopyhistory:V},props:{},data(){return{form:{auctionTicket:"",validDays:"",integral:"",usedTime:""},roomCheckList:[],loading:!1,relationInfo:{appointedNum:0,auctionNum:0,byLimit:0,integralLimit:0},serialNum:"",innerVisible:!1,centerDialogVisible:!1,isAdd:!0,drawerName:"",drawerData:{},menuList:[],activeMenu:"",activeRoom:"",roomList:[],associatedRoom:[],prices:[],CalculatePrice:{},ruleForm:{biddingPrice:5e3,transactionPrice:1e4,premiumRatio:6,integralRatio:30,depositRatio:1.1665,depositPrice:300,profitRatio:1,platformRatio:43},rules:{biddingPrice:[{required:!0,message:"输入起拍价(数字)",trigger:"blur"},{validator:this.testValidator,trigger:"blur"}],transactionPrice:[{required:!0,message:"输入交割价(数字)",trigger:"blur"},{validator:this.testValidator,trigger:"blur"}],premiumRatio:{required:!0,message:"输入溢价比(数字)",trigger:"blur"},integralRatio:{required:!0,message:"输入积分比(数字)",trigger:"blur"},depositRatio:{required:!0,message:"输入定金比(数字)",trigger:"blur"},depositPrice:{required:!0,message:"输入定金(数字)",trigger:"blur"},profitRatio:{required:!0,message:"输入个人收益(数字)",trigger:"blur"},platformRatio:{required:!0,message:"输入平台收益(数字)",trigger:"blur"}},goodsList:[],subGoodsList:[],value:!0,checkList:[],selectID:[],couponDrawer:!1}},created(){},mounted(){this.getConferenceHall()},activated(){},watch:{couponDrawer(){this.couponDrawer&&this.getAuctionTicketConfig()},roomList(e,t){if(0==e.length&&0==this.activeMenu.state){const e=this,t={id:this.activeMenu.id,roomCode:this.activeMenu.roomCode,state:"1",conferenceCode:this.activeMenu.conferenceHallCode},a=e.GLOBAL.paramJson(t);this.$axios.post(e.Api.updateConferenceHallState,a).then(t=>{0==t.data.head.status&&(e.activeMenu.state=1,e.$message({message:t.data.head.msg,type:"success"}))}).catch(t=>{e.activeMenu.state=0,e.$message({message:"失败",type:"error"})})}}},computed:{inDuringDate(){const e=new Date,t=new Date(this.activeMenu.startTime),a=new Date(this.activeMenu.endTime);return e>=t&&e<=a}},methods:{saveCouponConfig(){this.$axios.post(this.Api.setAuctionTicketConfig,this.GLOBAL.paramJson(this.form)).then(e=>{if(0!==e.data.head.status)return Promise.reject(e);this.$message.success("修改成功"),this.couponDrawer=!1}).catch(e=>{var t;this.$message.error(null!==(t=e.data.head.msg)&&void 0!==t?t:"修改失败")})},getAuctionTicketConfig(){this.$axios.post(this.Api.getAuctionTicketConfig,this.GLOBAL.paramJson()).then(e=>{this.form=e.data.body})},handleALL(e){this.handleSelect(e)},handleSelect(e){this.selectID=[],e.length>0&&e.forEach((e,t)=>{this.selectID.push(e.sortNum)})},rowClass({row:e,rowIndex:t}){if(this.selectID.includes(e.sortNum))return"activeRow"},checkNull(e,t,a,i){e[a]||(this.$refs[a+t].$el.querySelector("input").focus(),this.$message({message:i+"不能为空",type:"warning"}))},testValidator(e,t,a){return this.ruleForm.biddingPrice&&this.ruleForm.transactionPrice&&Number(this.ruleForm.biddingPrice)>Number(this.ruleForm.transactionPrice)?a(new Error("起拍价应小于交割价")):a()},menuClick(e){this.activeMenu=e,""==e?(this.roomList=[],this.activeRoom="",this.associatedRoom=[],this.clearData()):this.getRoomInfo()},roomClick(e){this.activeRoom=e,""==e?(this.activeRoom="",this.clearData()):this.getAuctionRoomInfo()},clearData(){this.prices=[],this.$refs.ruleForm.resetFields(),this.goodsList=[],this.checkList=[],this.relationInfo.appointedNum=0,this.relationInfo.auctionNum=0,this.relationInfo.byLimit=0,this.relationInfo.integralLimit=0},handleEditClick(){this.isAdd=!1,this.closeDialog(),this.openDrawer(this.drawerName,this.drawerData)},handleAddClick(e){this.isAdd=!0,this.openDrawer(e)},closeDialog(){this.innerVisible=!1,this.centerDialogVisible=!1},rightClick(e,t){0!=t.state?(this.drawerData=t,this.drawerName=e,this.centerDialogVisible=!0):this.$message({message:"请关闭后再操作",type:"warning"})},deleteItem(){const e=this;let t="",a=[],i="";"menuDrawer"===this.drawerName?(t=this.Api.delConferenceHallById,a=this.menuList):"areaDrawer"===this.drawerName&&(t=this.Api.delRoomInfo),i={id:this.drawerData.id||this.drawerData.roomId};const o=e.GLOBAL.paramJson(i);this.$axios.post(t,o).then(t=>{0===t.data.head.status?("menuDrawer"===this.drawerName?(e.menuList=a.filter(t=>t!==e.drawerData),e.drawerData==e.activeMenu&&e.menuList.length>0?e.menuClick(e.menuList[0]):0==e.menuList.length&&e.menuClick("")):(e.roomList=e.roomList.filter(t=>t!==e.drawerData),e.drawerData==e.activeRoom&&e.roomList.length>0?e.roomClick(e.roomList[0]):0==e.roomList.length&&e.roomClick("")),e.closeDialog()):e.$message({message:t.data.head.msg,type:"error"})}).catch(e=>{console.log(e)})},openDrawer(e,t){if("goodsDrawer"===e){if(this.inDuringDate||0==this.associatedRoom.length)return;this.$refs.goodsDrawer.handleOpen(),this.$refs.goodsDrawer.loadManage()}else this.$refs[e].handleOpen(t)},openRelationDrawer(){if(this.inDuringDate||0==this.associatedRoom.length)return;const e={conferenceCode:this.activeMenu.conferenceHallCode,roomCode:this.activeRoom.roomCode,integralLimit:this.relationInfo.integralLimit,byLimit:this.relationInfo.byLimit};this.openDrawer("relationDrawer",e)},relationChange(e){this.relationInfo.integralLimit=e.integralLimit,this.relationInfo.byLimit=e.byLimit},getRoomInfo(e){const t=this,a={conferenceCode:t.activeMenu.conferenceHallCode},i=t.GLOBAL.paramJson(a);this.$axios.post(this.Api.getRoomInfo,i).then(a=>{if(0===a.data.head.status)if(a.data.body.roomList.length>0&&(t.roomList=a.data.body.roomList),a.data.body.associatedRoom.length>0){t.associatedRoom=a.data.body.associatedRoom;const i=t.associatedRoom.find(e=>e.roomCode==t.activeRoom.roomCode);i&&1==e?t.activeRoom=i:(t.activeRoom=a.data.body.associatedRoom[0],t.getAuctionRoomInfo());let o=[];t.associatedRoom.forEach(e=>{o.push(e.roomCode)}),t.roomCheckList=o}else t.associatedRoom=[],t.roomCheckList=[],t.activeRoom="",t.clearData();else t.$message({message:a.data.head.msg,type:"warning"})}).catch(e=>{console.log(e)})},getConferenceHall(e){const t=this,a={conferenceHallName:"",startstartTime:"",endstartTime:"",startendTime:"",endendTime:"",pageNum:1,pageSize:99},i=t.GLOBAL.paramJson(a);this.$axios.post(this.Api.getConferenceHall,i).then(a=>{0===a.data.head.status&&a.data.body.resultList.length>0&&(t.menuList=a.data.body.resultList,""==t.activeMenu?(t.activeMenu=a.data.body.resultList[0],t.getRoomInfo()):"loadRoomInfo"==e&&t.getRoomInfo())}).catch(e=>{console.log(e)})},reloadManage(e,t){if("menuDrawer"===e)if(t){let e=this.menuList.filter(e=>e.id===t.id);e[0].conferenceHallName=t.conferenceHallName,e[0].startTime=t.startTime,e[0].endTime=t.endTime}else this.getConferenceHall();else if(e="areaDrawer")if(t){let e=this.roomList.filter(e=>e.roomId===t.id),a=this.associatedRoom.find(e=>e.roomId==t.id);a&&(a.roomName=t.roomName),e[0].roomName=t.roomName}else this.getRoomInfo(1)},ClickCopy(e){this.$refs.copyPrice.handleOpen(e,this.goodsList)},CopyGoodsPrice(e){let t=this.goodsList.find(t=>t.goodsCode==e.goodsCode);t.price=e.price,t.startingPrice=e.startingPrice,t.transactionPrice=e.transactionPrice,t.premiumRatio=e.premiumRatio,t.integralRatio=e.integralRatio,t.depositRatio=e.depositRatio,this.checkList=[e.goodsCode],this.handleCheckedChange(t),this.$refs.priceRef.toggleAllSelection(),this.$message({message:"复制成功",type:"success"})},menuChange(e,t){let a="",i="";0==e.state?a="关闭":1==e.state&&(a="开启"),1==t&&0==this.relationInfo.integralLimit&&0==this.relationInfo.byLimit&&(i="当前宝玉和积分为0，"),this.$confirm(`${i}确认要在app里${a}预约竞拍吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{let a="";a=1===t?this.Api.updateRoomState:this.Api.updateConferenceHallState;const i=this,o={id:e.id,roomCode:e.roomCode,state:0==e.state?"1":"0",conferenceCode:this.activeMenu.conferenceHallCode};e.state=0==e.state?"1":"0";const s=i.GLOBAL.paramJson(o);this.$axios.post(a,s).then(t=>{0!==t.data.head.status?(e.state=0==e.state?"1":"0",i.$message({message:t.data.head.msg,type:"error"})):i.$message({message:t.data.head.msg,type:"success"})}).catch(t=>{e.state=!e.state,i.$message({message:"失败",type:"error"})})}).catch(()=>{})},getCalculatePrice(){this.$refs.ruleForm.validate(e=>{if(e){const e=this;if(0==e.checkList.length)return void e.$message({message:"请选择商品",type:"warning"});this.CalculatePrice=JSON.parse(JSON.stringify(this.ruleForm));const t={biddingPrice:this.CalculatePrice.biddingPrice,depositRatio:this.CalculatePrice.depositRatio,premiumRatio:this.CalculatePrice.premiumRatio,integralRatio:this.CalculatePrice.integralRatio,transactionPrice:this.CalculatePrice.transactionPrice,depositPrice:this.CalculatePrice.depositPrice,profitRatio:this.CalculatePrice.profitRatio,platformRatio:this.CalculatePrice.platformRatio},a=e.GLOBAL.paramJson(t);this.$axios.post(this.Api.getCalculatePrice,a).then(t=>{0===t.data.head.status?(t.data.body.result.forEach((e,t)=>{e.sortNum=t}),e.prices=t.data.body.result,e.selectID=[],e.CalculatePrice.prices=e.prices,e.subGoodsList=e.checkList):e.$message({message:t.data.head.msg,type:"error"})}).catch(e=>{console.log(e)})}})},addGoodsAndPriceDetailed(){const e=this;let t=this.$refs.priceRef.selection;t.sort((e,t)=>e.platformRevenue-t.platformRevenue),0!=e.checkList.length?this.prices&&0!=this.prices.length?0!=t.length?this.$confirm("请确认保存价格?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{let a=[],i="";e.checkList.forEach((e,o)=>{i={biddingPrice:this.CalculatePrice.biddingPrice,transactionPrice:this.CalculatePrice.transactionPrice,premiumRatio:this.CalculatePrice.premiumRatio,depositRatio:this.CalculatePrice.depositRatio,integralRatio:this.CalculatePrice.integralRatio,prices:t,goodsCode:e},a.push(i)});const o={conferenceCode:this.activeMenu.conferenceHallCode,roomCode:this.activeRoom.roomCode,serialNum:this.serialNum,goodsList:a},s=e.GLOBAL.paramJson(o);this.$axios.post(this.Api.addGoodsAndPriceDetailed,s).then(t=>{0===t.data.head.status?(e.$message({message:t.data.head.msg,type:"success"}),e.setgoodsManage(i),e.selectID=[],e.$refs.priceRef.clearSelection()):e.$message({message:t.data.head.msg,type:"warning"})}).catch(e=>{console.log(e)})}).catch(()=>{}):e.$message({message:"请勾选已生成价格",type:"warning"}):e.$message({message:"请重新生成模拟价格",type:"warning"}):e.$message({message:"请选择商品",type:"warning"})},setgoodsManage(e){let t=this.goodsList.filter(e=>-1!=this.checkList.indexOf(e.goodsCode));t.forEach((function(t){t.price=e.prices,t.startingPrice=e.biddingPrice,t.transactionPrice=e.transactionPrice,t.premiumRatio=e.premiumRatio,t.depositRatio=e.depositRatio,t.integralRatio=e.integralRatio}))},getAuctionRoomInfo(){const e=this;this.loading=!0;const t={conferenceHallCode:this.activeMenu.conferenceHallCode,roomCode:this.activeRoom.roomCode};this.prices=[],this.selectID=[],this.$refs.ruleForm.resetFields(),this.goodsList=[],this.checkList=[],e.relationInfo.appointedNum=0,e.relationInfo.auctionNum=0,e.relationInfo.byLimit=0,e.relationInfo.integralLimit=0;const a=e.GLOBAL.paramJson(t);this.$axios.post(this.Api.getAuctionRoomInfo,a).then(t=>{0===t.data.head.status&&t.data.body?(t.data.body.auctionGoodsInfo&&(e.goodsList=t.data.body.auctionGoodsInfo),e.serialNum=t.data.body.serialNum,e.relationInfo=t.data.body):0!==t.data.head.status&&e.$message({message:t.data.head.msg,type:"error"}),setTimeout(()=>{this.loading=!1},500)}).catch(e=>{setTimeout(()=>{this.loading=!1},500),console.log(e)})},addGoods(e){const t=e.filter(e=>!this.goodsList.some(t=>t.goodsCode==e.goodsCode));this.goodsList.push(...t),t.length!=e.length?this.$message({message:`成功添加${t.length}条，有${e.length-t.length}条重复数据`,type:"warning"}):this.$message({message:`成功添加${t.length}条`,type:"success"})},handleCheckedChange(e){if(1==this.checkList.length){const e=this.goodsList.find(e=>-1!=this.checkList.indexOf(e.goodsCode));e.price instanceof Array?(this.ruleForm.biddingPrice=e.startingPrice,this.ruleForm.transactionPrice=e.transactionPrice,this.ruleForm.premiumRatio=e.premiumRatio,this.ruleForm.depositRatio=e.depositRatio,this.ruleForm.integralRatio=e.integralRatio,this.ruleForm.depositPrice=300,this.ruleForm.profitRatio=1,this.ruleForm.platformRatio=43,this.CalculatePrice=JSON.parse(JSON.stringify(this.ruleForm)),this.selectID=[],this.prices=e.price):(this.selectID=[],this.prices=[],this.$refs.ruleForm.resetFields())}else this.prices=[],this.$refs.ruleForm.resetFields()},deleteGoods(e){this.$confirm("请确认是否删除"+e.goodsName,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const t=this;if(e.price instanceof Array){const a={conferenceCode:this.activeMenu.conferenceHallCode,roomCode:this.activeRoom.roomCode,serialNum:this.serialNum,goodsList:[e.goodsCode]},i=t.GLOBAL.paramJson(a);this.$axios.post(t.Api.delAuctionGoodsInfo,i).then(a=>{0===a.data.head.status?(t.goodsList=t.goodsList.filter(t=>t.goodsCode!=e.goodsCode),t.checkList=t.checkList.filter(t=>t!=e.goodsCode),t.handleCheckedChange(),t.$message({type:"success",message:"删除成功!"})):t.$message({message:a.data.head.msg,type:"warning"})}).catch(e=>{console.log(e)})}else t.goodsList=t.goodsList.filter(t=>t.goodsCode!=e.goodsCode),t.checkList=t.checkList.filter(t=>t!=e.goodsCode),t.handleCheckedChange(),this.$message({type:"success",message:"删除成功!"})}).catch(()=>{})},roomCheckListChange(e,t){const a=this;!0===e?this.$confirm(`请确认是否绑定 ${t.roomName} 分区`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const e={conferenceCode:this.activeMenu.conferenceHallCode,roomCode:t.roomCode},i=a.GLOBAL.paramJson(e);this.$axios.post(this.Api.addConferenceRelation,i).then(e=>{if(0!=e.data.head.status)return a.$message({message:e.data.head.msg,type:"warning"}),void(this.roomCheckList=this.roomCheckList.filter(e=>e!=t.roomCode));a.getRoomInfo(1),this.$message({type:"success",message:"绑定成功成功!"})}).catch(e=>{console.log(e)})}).catch(()=>{this.$message({type:"info",message:"已取消"}),this.roomCheckList=this.roomCheckList.filter(e=>e!=t.roomCode)}):this.$confirm(`解除 ${t.roomName} 将会删除相关配置内容，确认吗`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const e=a.associatedRoom.find(e=>e.roomCode==t.roomCode),i={conferenceCode:this.activeMenu.conferenceHallCode,roomCode:t.roomCode,serialNum:e.serialNum},o=this.GLOBAL.paramJson(i);this.$axios.post(this.Api.delConferenceRelation,o).then(i=>{if(0==i.data.head.status){const i=a.associatedRoom.filter(e=>e.roomCode!=t.roomCode);a.associatedRoom=i,a.associatedRoom.length>0&&e.roomCode==a.activeRoom.roomCode?a.roomClick(a.associatedRoom[0]):0==a.associatedRoom.length&&a.roomClick(""),this.$message({type:"success",message:"解除绑定成功!"})}else a.$message({message:i.data.head.msg,type:"warning"})}).catch(e=>{console.log(e)})}).catch(()=>{this.roomCheckList.push(t.roomCode),this.$message({type:"info",message:"已取消"})})},handleCopyHistory(){this.closeDialog(),this.menuList.length>0?this.$refs.copyhistory.handleOpen(this.menuList,this.drawerData):this.$message({type:"error",message:"场次列表为空"})},CopyHistory(){this.getConferenceHall("loadRoomInfo")}}},J=E,U=(a("8433"),a("c970"),Object(c["a"])(J,i,o,!1,null,"b33fd71e",null));t["default"]=U.exports},c970:function(e,t,a){"use strict";a("56bb")},d8d8:function(e,t,a){"use strict";a("22db")},e0e0:function(e,t,a){"use strict";a("f740")},e5c1:function(e,t,a){"use strict";a("4b71")},ef4d:function(e,t,a){"use strict";a("711d")},f6d5:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"common-search"},[a("div",{ref:"opeSlideBox",staticClass:"operateBox"},[a("div",{staticClass:"searchBox"},[a("div",{staticClass:"itemBox"},e._l(e.headArr,(function(t,i){return a("div",{key:i},[t.noSearchShow?e._e():a("div",{staticClass:"searchItem"},["文本"==t.fieldType?a("div",["文本"==t.fieldType?a("div",{staticClass:"searchTit"},[e._v(e._s(t.fieldName))]):e._e(),"文本"==t.fieldType?a("el-input",{attrs:{placeholder:"请输入搜索内容","prefix-icon":"el-icon-search",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.clickSearch()}},model:{value:t.searchValKey,callback:function(a){e.$set(t,"searchValKey",a)},expression:"item.searchValKey"}}):e._e()],1):e._e(),"值列"==t.fieldType?a("div",["值列"==t.fieldType?a("div",{staticClass:"searchTit"},[e._v(e._s(t.fieldName))]):e._e(),"值列"==t.fieldType?a("el-select",{attrs:{clearable:"",placeholder:"请选择"},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.clickSearch()}},model:{value:t.searchValKey,callback:function(a){e.$set(t,"searchValKey",a)},expression:"item.searchValKey"}},e._l(t.fieldAttr,(function(e){return a("el-option",{key:e.optionKey,attrs:{label:e.optionValue,value:e.optionKey}})})),1):e._e()],1):e._e(),"日期"==t.fieldType?a("div",["日期"==t.fieldType?a("div",{staticClass:"searchTit"},[e._v(e._s(t.fieldName))]):e._e(),"日期"==t.fieldType?a("el-date-picker",{attrs:{type:"daterange","value-format":"yyyy-MM-dd","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期"},on:{change:e.onChange},model:{value:t.searchValKey,callback:function(a){e.$set(t,"searchValKey",a)},expression:"item.searchValKey"}}):e._e()],1):e._e(),"时间"==t.fieldType?a("div",["时间"==t.fieldType?a("div",{staticClass:"searchTit"},[e._v(e._s(t.fieldName))]):e._e(),"时间"==t.fieldType?a("el-time-picker",{attrs:{"is-range":"","value-format":"HH:mm","range-separator":"-","start-placeholder":"开始时间","end-placeholder":"结束时间",placeholder:"选择时间范围"},model:{value:t.searchValKey,callback:function(a){e.$set(t,"searchValKey",a)},expression:"item.searchValKey"}}):e._e()],1):e._e(),"日期时间"==t.fieldType?a("div",["日期时间"==t.fieldType?a("div",{staticClass:"searchTit"},[e._v(e._s(t.fieldName))]):e._e(),"日期时间"==t.fieldType?a("el-date-picker",{attrs:{type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"选择日期时间"},model:{value:t.searchValKey,callback:function(a){e.$set(t,"searchValKey",a)},expression:"item.searchValKey"}}):e._e()],1):e._e()])])})),0),a("div",{staticClass:"searchBtnBox"},[a("el-button",{attrs:{size:"small",icon:"el-icon-refresh",type:"primary"},on:{click:function(t){return e.clickSearch()}}},[e._v("查询")]),a("el-button",{attrs:{size:"small",icon:"el-icon-close",type:"info"},on:{click:function(t){return e.clearSearch()}}},[e._v("清空")])],1),e.foldFlag?a("div",{staticClass:"moreBtn",on:{click:e.clickMore}},[e.foldFlag?a("i",{staticClass:"el-icon-caret-bottom"}):e._e()]):a("div",{staticClass:"newMoreBtn",on:{click:e.clickMore}},[a("i",{staticClass:"el-icon-caret-top"})])])])])},o=[],s={name:"CommonSearch",props:{headTitArr:Array,pageNum:Number,pageSize:Number,OtherData:Object,serverName:String,requestUrl:String,cmdVal:Number},data(){return{height:"180px",searchName:"",foldFlag:!0,headArr:"",tableEmptyText:"",total:"",tableData:"",pMsg:[{key:"pageNum",value:"1",isTrue:!0,msg:"请确认pageNum"},{key:"pageSize",value:"10",isTrue:!0,msg:"请确认pageSize"}]}},created(){this.headArr=this.headTitArr,this.curRequestUrl=this.requestUrl,this.headArr.forEach(e=>{"值列"===e.fieldType&&e.fieldAttr&&"string"===typeof e.fieldAttr&&(e.fieldAttr=JSON.parse(e.fieldAttr))})},mounted(){},activated(){},methods:{onChange(){},clickMore(){this.foldFlag=!this.foldFlag,this.foldFlag?(this.$refs.opeSlideBox.style.height="60px",this.$refs.opeSlideBox.style.overflow="hidden"):(this.$refs.opeSlideBox.style.height=this.height,this.$refs.opeSlideBox.style.overflow="auto")},parentMsgs(e){this.pMsg=e,this.searchList()},parentMsg(){},getRequestUrl(e,t){},parentHeadArr(e){},sendOptions(e){},handleChangeBand(e){},resetSearch(e,t){this.pMsg=e;let a=null;t&&(a=t),this.clearSearch(a)},clickSearch(){this.searchList(1)},searchList(e){e&&this.pMsg.forEach(t=>{"pageNum"===t.key&&(t.value=e)}),this.$emit("changeLoading",!0);let t="";this.headArr.forEach(e=>{e.searchValKey&&("日期"===e.fieldType?t+=`"start${e.fieldKey}":"${e.searchValKey[0]}","end${e.fieldKey}":"${e.searchValKey[1]}",`:t+=`"${e.fieldKey}":"${e.searchValKey}",`)});let a="";for(let c=0;c<this.pMsg.length;c++)this.pMsg[c].isTrue&&!this.pMsg[c].value?(this.$message({message:this.pMsg[c].msg,type:"warning"}),this.$emit("changeLoading",!1)):a+=`"${this.pMsg[c].key}":"${this.pMsg[c].value}",`;for(let c in this.OtherData)a+=`"${c}":"${this.OtherData[c]}",`;const i=null;let o="",s="",r="";s+=i?`{${t}${a}${i}}`:`{${t}${a}}`;const l=s.slice(0,s.length-2),n=s.substr(s.length-1,1);if(o=l+n,r=JSON.parse(o),this.curRequestUrl){const t=this,a=t.GLOBAL.paramJson(r);t.$axios.post(t.curRequestUrl,a).then(a=>{t.$emit("changeLoading",!1),0===a.data.head.status&&(a.data.body.result?t.tableData=a.data.body.result:a.data.body.resultList?t.tableData=a.data.body.resultList:a.data.body.usersList?t.tableData=a.data.body.usersList:a.data.body.allResultList&&(t.tableData=a.data.body.allResultList),0===t.tableData.length&&(t.tableEmptyText="暂无数据",t.$message({message:"请求成功，暂无数据",type:"success"})),a.data.body.totalCount?t.total=a.data.body.totalCount:a.data.body.count&&(t.total=a.data.body.count),t.$emit("sendData",t.tableData,t.total,t.tableEmptyText,e,r))})}},clearSearch(e){const t=e||1;this.$emit("changeLoading",!0),this.pMsg.forEach(e=>{"pageNum"===e.key&&(e.value=t)});let a="";this.headArr.forEach(e=>{e.searchValKey&&(this.$set(e,"searchValKey",""),"日期"===e.fieldType?a+=`"start${e.fieldKey}":"${e.searchValKey[0]}","end${e.fieldKey}":"${e.searchValKey[1]}",`:a+=`"${e.fieldKey}":"${e.searchValKey}",`)});let i="";for(let m=0;m<this.pMsg.length;m++)this.pMsg[m].isTrue&&!this.pMsg[m].value?(this.$message({message:this.pMsg[m].msg,type:"warning"}),this.$emit("changeLoading",!1)):i+=`"${this.pMsg[m].key}":"${this.pMsg[m].value}",`;let o="",s="";s+=`{${a}${i}}`;const r=s.slice(0,o.length-2),l=s.substr(o.length-1,1);o=r+l;const n=JSON.parse(o),c=this,d=c.GLOBAL.paramJson(n);c.$axios.post(c.curRequestUrl,d).then(e=>{c.$emit("changeLoading",!1),0===e.data.head.status&&(e.data.body.result?c.tableData=e.data.body.result:e.data.body.resultList?c.tableData=e.data.body.resultList:e.data.body.usersList?c.tableData=e.data.body.usersList:e.data.body.allResultList&&(c.tableData=e.data.body.allResultList),0===c.tableData.length&&(c.tableEmptyText="暂无数据",c.$message({message:"请求成功，暂无数据",type:"success"})),e.data.body.totalCount?c.total=e.data.body.totalCount:e.data.body.count&&(c.total=e.data.body.count),c.$emit("sendData",c.tableData,c.total,c.tableEmptyText,t))})}}},r=s,l=(a("72fc"),a("b709")),n=Object(l["a"])(r,i,o,!1,null,"1aad5c45",null);t["a"]=n.exports},f740:function(e,t,a){}}]);